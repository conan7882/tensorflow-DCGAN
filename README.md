## Deep Convolutional Generative Adversarial Networks (DCGAN)


- TensorFlow implementation of [Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks](https://arxiv.org/abs/1511.06434). 

- The DCGAN model is defined [here](https://github.com/conan7882/DeepVision-tensorflow/tree/master/tensorcv/algorithms/GAN).

- Please refer to the docs (coming soon) for custom configuration of the model and the callbacks setup.
- 
## Requirements
- Python 3.3+
- [Tensorflow 1.0+](https://www.tensorflow.org/)
- [TensorCV](https://github.com/conan7882/DeepVision-tensorflow)

## Results

### CIFAR10
![cifar_result1](fig/cifar_result.png)

### MNIST

![MNIST_result1](fig/mnist_result.png)

*More results will be added later.*




## Usage
### Config path
All directories are setup in *config.py*.

- Before training, put all the training images in *`config.data_dir`*.
- Trained model will be saved in *`config.model_dir`* every 100 steps.
- Summary will be saved *`config.summary_dir`* every 10 steps in.
- Sample generated images will be saved in *`config.infer_dir`* every 100 training steps.
- Images generated during testing will be saved in *`config.result_dir`*.


**Please note, all the images should have the same size.**


### Run script

- You can run this script on CIFAR10, MNIST dataset as well as your own dataset in format of Matlab .mat files and image files.



To train a model on CIFAR10 and MNIST dataset:

	$ python DCGAN.py --train --cifar --batch_size 64
	$ python DCGAN.py --train --mnist --batch_size 64


To train on your own dataset:

.mat files:

	$ python DCGAN.py --train --matlab --batch_size 64 --mat_name MAT_NAME_IN_MAT_FILE

images files:

	$ python DCGAN.py --train --image --batch_size 64 --type IMAGE_FILE_EXTENSION(start with '.')
	 
To test using an existing model, size and channels of images used for training the model need to be specified, and the batch size has to be the same as training:

	$ python DCGAN.py --predict --batch_size SAME_AS_TRAINING --h IMAGE_HEIGHT\
	 --w IMAGE_WIDTH --input_channel NUM_INPUT_CHANNEL
	


## Training Details
- Both discriminator and generator use learning rate 0.0002
- To avoid small discriminator loss, update generator twice for each update of discriminator, as suggested [here](https://github.com/carpedm20/DCGAN-tensorflow#dcgan-in-tensorflow).
- init

## Default Summary
### Scalar:
- loss of generator and discriminator

### Histogram:
- gradients of generator and discriminator
- discriminator output for real image and generated image

### Image
- real image and generated image

## Custom Configuration
*details can be found in docs (coming soon)*
### Available callbacks:

- TrainSummary()
- CheckScalar()
- GANInference()
 
### Available inferencer:
- InferImages()


## Training Details

## Author
Qian Ge





